<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAT Preparation - Focus & Learn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a1d29;
            --secondary: #ff6b6b;
            --accent: #4ecdc4;
            --neutral: #f8f9fa;
            --text-dark: #2d3748;
            --text-light: #718096;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-blur {
            backdrop-filter: blur(20px);
            background: rgba(26, 29, 41, 0.9);
        }
        
        .question-card {
            transition: all 0.3s ease;
        }
        
        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .answer-option {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .answer-option:hover {
            background-color: #f3f4f6;
            transform: translateX(4px);
        }
        
        .answer-option.selected {
            background-color: #dbeafe;
            border-color: #3b82f6;
        }
        
        .answer-option.correct {
            background-color: #dcfce7;
            border-color: #16a34a;
        }
        
        .answer-option.incorrect {
            background-color: #fee2e2;
            border-color: #dc2626;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .math-formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
        }
    </style>
<base target="_blank">
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 nav-blur">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-r from-coral-400 to-accent-400 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">F&L</span>
                    </div>
                    <span class="text-white font-semibold text-lg">Focus & Learn</span>
                </div>
                <div class="flex space-x-8">
                    <a href="index.html" class="text-gray-300 hover:text-white transition-colors px-1 py-2">Dashboard</a>
                    <a href="sat-prep.html" class="text-white font-medium border-b-2 border-secondary px-1 py-2">SAT Prep</a>
                    <a href="brain-games.html" class="text-gray-300 hover:text-white transition-colors px-1 py-2">Brain Games</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="pt-24 pb-8 bg-gradient-to-r from-blue-600 to-purple-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center text-white">
                <h1 class="text-4xl lg:text-5xl font-bold mb-4">SAT Preparation</h1>
                <p class="text-xl text-blue-100 mb-8">Master reading comprehension and mathematics with adaptive practice</p>
                
                <!-- Progress Overview -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                    <div class="glass-effect rounded-xl p-4">
                        <div class="text-2xl font-bold mb-1" id="questions-answered">127</div>
                        <div class="text-sm text-blue-100">Questions Answered</div>
                    </div>
                    <div class="glass-effect rounded-xl p-4">
                        <div class="text-2xl font-bold mb-1" id="accuracy-rate">85%</div>
                        <div class="text-sm text-blue-100">Accuracy Rate</div>
                    </div>
                    <div class="glass-effect rounded-xl p-4">
                        <div class="text-2xl font-bold mb-1" id="study-streak">12</div>
                        <div class="text-sm text-blue-100">Day Streak</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-8 bg-gray-50 min-h-screen">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                
                <!-- Topic Selector Sidebar -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-2xl p-6 shadow-lg sticky top-24">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Practice Areas</h3>
                        
                        <div class="space-y-4">
                            <button onclick="selectTopic('reading')" id="reading-btn" 
                                    class="w-full text-left p-4 rounded-xl border-2 border-blue-200 bg-blue-50 text-blue-700 font-semibold">
                                <div class="flex items-center justify-between">
                                    <span>üìñ Reading</span>
                                    <span class="text-sm">68%</span>
                                </div>
                                <div class="w-full bg-blue-200 rounded-full h-2 mt-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 68%"></div>
                                </div>
                            </button>
                            
                            <button onclick="selectTopic('math')" id="math-btn" 
                                    class="w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-gray-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>üßÆ Mathematics</span>
                                    <span class="text-sm text-gray-500">45%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 45%"></div>
                                </div>
                            </button>
                            
                            <button onclick="selectTopic('writing')" id="writing-btn" 
                                    class="w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-gray-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <span>‚úçÔ∏è Writing</span>
                                    <span class="text-sm text-gray-500">23%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: 23%"></div>
                                </div>
                            </button>
                        </div>
                        
                        <div class="mt-8 pt-6 border-t border-gray-200">
                            <h4 class="font-semibold text-gray-900 mb-4">Quick Stats</h4>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Today's Practice:</span>
                                    <span class="font-semibold">25 min</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">This Week:</span>
                                    <span class="font-semibold">3h 45m</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Best Streak:</span>
                                    <span class="font-semibold">18 days</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question Interface -->
                <div class="lg:col-span-3">
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        
                        <!-- Question Header -->
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-2xl font-bold" id="topic-title">Reading Comprehension</h2>
                                <div class="flex items-center space-x-4">
                                    <span class="text-sm" id="question-counter">Question 1 of 5</span>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-sm">‚è±Ô∏è</span>
                                        <span class="text-sm" id="timer-display">--:--</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Progress Bar -->
                            <div class="w-full bg-white bg-opacity-30 rounded-full h-2">
                                <div class="bg-white rounded-full h-2 progress-bar" id="session-progress" style="width: 20%"></div>
                            </div>
                        </div>

                        <!-- Question Content -->
                        <div class="p-8">
                            <div id="question-container" class="fade-in">
                                
                                <!-- Reading Passage (for reading questions) -->
                                <div id="reading-passage" class="mb-8 p-6 bg-gray-50 rounded-xl border-l-4 border-blue-500 hidden">
                                    <h4 class="font-semibold text-gray-900 mb-3">Reading Passage</h4>
                                    <p class="text-gray-700 leading-relaxed" id="passage-text"></p>
                                </div>

                                <!-- Question Text -->
                                <div class="mb-8">
                                    <h3 class="text-xl font-semibold text-gray-900 mb-4" id="question-text">
                                        According to the passage, what is the primary purpose of the author's discussion of neural plasticity?
                                    </h3>
                                </div>

                                <!-- Answer Options -->
                                <div class="space-y-3 mb-8" id="answer-options">
                                    <div class="answer-option p-4 border-2 border-gray-200 rounded-xl" onclick="selectAnswer(0)">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-4 font-semibold">A</div>
                                            <span>To explain how the brain adapts to new learning experiences through physical changes in neural pathways</span>
                                        </div>
                                    </div>
                                    <div class="answer-option p-4 border-2 border-gray-200 rounded-xl" onclick="selectAnswer(1)">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-4 font-semibold">B</div>
                                            <span>To argue that cognitive training is more effective than traditional study methods</span>
                                        </div>
                                    </div>
                                    <div class="answer-option p-4 border-2 border-gray-200 rounded-xl" onclick="selectAnswer(2)">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-4 font-semibold">C</div>
                                            <span>To demonstrate that brain training games have no real cognitive benefits</span>
                                        </div>
                                    </div>
                                    <div class="answer-option p-4 border-2 border-gray-200 rounded-xl" onclick="selectAnswer(3)">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-4 font-semibold">D</div>
                                            <span>To compare the effectiveness of different types of mental exercises</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Math Problem (for math questions) -->
                                <div id="math-problem" class="mb-8 hidden">
                                    <div class="bg-gray-50 rounded-xl p-6">
                                        <h4 class="font-semibold text-gray-900 mb-4">Solve the following equation:</h4>
                                        <div class="math-formula text-center text-2xl mb-6" id="math-formula">
                                            2x¬≤ + 5x - 3 = 0
                                        </div>
                                        <p class="text-gray-600 text-center">What is the value of x?</p>
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="flex justify-between items-center">
                                    <button onclick="previousQuestion()" id="prev-btn" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-colors" disabled>
                                        ‚Üê Previous
                                    </button>
                                    
                                    <div class="flex space-x-4">
                                        <button onclick="skipQuestion()" class="px-6 py-3 bg-yellow-500 text-white rounded-xl font-semibold hover:bg-yellow-600 transition-colors">
                                            Skip
                                        </button>
                                        <button onclick="submitAnswer()" id="submit-btn" class="px-6 py-3 bg-secondary text-white rounded-xl font-semibold hover:bg-red-600 transition-colors" disabled>
                                            Submit Answer
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Explanation Panel (shown after answer submission) -->
                            <div id="explanation-panel" class="mt-8 p-6 bg-blue-50 rounded-xl border-l-4 border-blue-500 hidden">
                                <h4 class="font-semibold text-blue-900 mb-3">Explanation</h4>
                                <p id="explanation-text" class="text-blue-800 mb-4">
                                    The correct answer is A. The author discusses neural plasticity to explain how the brain physically changes and adapts when we learn new skills or information. This concept supports the idea that cognitive training can lead to measurable improvements in brain function.
                                </p>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <span class="text-sm text-blue-600">You earned:</span>
                                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm font-semibold">+10 XP</span>
                                    </div>
                                    <button onclick="nextQuestion()" class="px-6 py-2 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-colors">
                                        Next Question ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Chart -->
                    <div class="mt-8 bg-white rounded-2xl p-6 shadow-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Performance Trends</h3>
                        <div id="performance-chart" style="height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 text-center">
            <div class="text-6xl mb-4">üéâ</div>
            <h3 class="text-2xl font-bold text-gray-900 mb-2">Excellent Work!</h3>
            <p id="success-message" class="text-gray-600 mb-6">You completed 5 questions with 80% accuracy!</p>
            <div class="bg-yellow-50 rounded-xl p-4 mb-6">
                <div class="text-2xl font-bold text-yellow-600" id="xp-earned">+50 XP</div>
                <div class="text-sm text-yellow-700">Experience Points Earned</div>
            </div>
            <button onclick="closeSuccessModal()" class="w-full bg-secondary text-white py-3 rounded-xl font-semibold hover:bg-red-600 transition-colors">
                Continue Learning
            </button>
        </div>
    </div>

    <script>
        // SAT Prep Application
        class SATPrepApp {
            constructor() {
                this.currentTopic = 'reading';
                this.currentQuestion = 0;
                this.selectedAnswer = null;
                this.sessionQuestions = [];
                this.sessionAnswers = [];
                this.sessionStartTime = Date.now();
                this.timerInterval = null;
                this.questionStartTime = Date.now();
                
                this.questions = {
                    reading: [
                        {
                            passage: `Neuroplasticity, the brain's remarkable ability to reorganize itself by forming new neural connections, has revolutionized our understanding of cognitive development. Research demonstrates that engaging in challenging mental activities can literally reshape the brain's structure and enhance its function. This adaptability means that cognitive training through games, puzzles, and focused learning exercises can lead to measurable improvements in memory, attention, and problem-solving skills.`,
                            question: "According to the passage, what is the primary purpose of the author's discussion of neural plasticity?",
                            options: [
                                "To explain how the brain adapts to new learning experiences through physical changes in neural pathways",
                                "To argue that cognitive training is more effective than traditional study methods",
                                "To demonstrate that brain training games have no real cognitive benefits",
                                "To compare the effectiveness of different types of mental exercises"
                            ],
                            correct: 0,
                            explanation: "The correct answer is A. The author discusses neural plasticity to explain how the brain physically changes and adapts when we learn new skills or information. This concept supports the idea that cognitive training can lead to measurable improvements in brain function."
                        },
                        {
                            passage: `The digital revolution has transformed education, creating both unprecedented opportunities and significant challenges. While students now have access to vast repositories of knowledge and innovative learning tools, they also face increased distractions from social media, gaming, and constant connectivity. The key to harnessing technology's educational potential lies in developing digital literacy skills and creating structured learning environments that leverage technology's strengths while minimizing its distractions.`,
                            question: "What is the author's main argument about the impact of digital technology on education?",
                            options: [
                                "Technology has completely revolutionized education for the better",
                                "Digital technology presents both advantages and disadvantages for learning",
                                "Students should avoid using technology for educational purposes",
                                "Traditional teaching methods are more effective than digital tools"
                            ],
                            correct: 1,
                            explanation: "The correct answer is B. The author presents a balanced view, acknowledging both the opportunities (access to knowledge, innovative tools) and challenges (distractions, connectivity issues) that digital technology brings to education."
                        }
                    ],
                    math: [
                        {
                            question: "Solve the equation: 2x¬≤ + 5x - 3 = 0",
                            options: ["x = 1/2 or x = -3", "x = -1/2 or x = 3", "x = 1/2 or x = 3", "x = -1/2 or x = -3"],
                            correct: 0,
                            explanation: "Using the quadratic formula: x = (-b ¬± ‚àö(b¬≤ - 4ac)) / 2a, where a=2, b=5, c=-3. This gives us x = 1/2 or x = -3."
                        },
                        {
                            question: "If f(x) = 3x + 2 and g(x) = x¬≤ - 1, what is f(g(2))?",
                            options: ["11", "13", "15", "17"],
                            correct: 2,
                            explanation: "First calculate g(2) = 2¬≤ - 1 = 3. Then f(g(2)) = f(3) = 3(3) + 2 = 11."
                        }
                    ],
                    writing: [
                        {
                            question: "Which sentence demonstrates the most effective use of parallel structure?",
                            options: [
                                "She enjoys hiking, to swim, and biking.",
                                "She enjoys hiking, swimming, and biking.",
                                "She enjoys to hike, swimming, and to bike.",
                                "She enjoys hiking, swimming, and to bike."
                            ],
                            correct: 1,
                            explanation: "The correct answer is B. All items in the list use the same grammatical form (-ing verbs), creating proper parallel structure."
                        }
                    ]
                };
                
                this.init();
            }

            init() {
                this.selectTopic('reading');
                this.initChart();
                this.bindEvents();
            }

            selectTopic(topic) {
                this.currentTopic = topic;
                this.currentQuestion = 0;
                this.selectedAnswer = null;
                this.sessionQuestions = this.questions[topic].sort(() => Math.random() - 0.5).slice(0, 5);
                this.sessionAnswers = [];
                
                // Update UI
                this.updateTopicButtons();
                this.loadQuestion();
                this.startTimer();
            }

            updateTopicButtons() {
                const buttons = ['reading-btn', 'math-btn', 'writing-btn'];
                buttons.forEach(btnId => {
                    const btn = document.getElementById(btnId);
                    if (btn) {
                        if (btnId === `${this.currentTopic}-btn`) {
                            btn.className = 'w-full text-left p-4 rounded-xl border-2 border-blue-200 bg-blue-50 text-blue-700 font-semibold';
                        } else {
                            btn.className = 'w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-gray-300 transition-colors';
                        }
                    }
                });
            }

            loadQuestion() {
                const question = this.sessionQuestions[this.currentQuestion];
                if (!question) return;

                // Reset state
                this.selectedAnswer = null;
                this.questionStartTime = Date.now();
                
                // Hide explanation panel
                document.getElementById('explanation-panel').classList.add('hidden');
                
                // Update progress
                const progress = ((this.currentQuestion + 1) / this.sessionQuestions.length) * 100;
                document.getElementById('session-progress').style.width = `${progress}%`;
                document.getElementById('question-counter').textContent = `Question ${this.currentQuestion + 1} of ${this.sessionQuestions.length}`;
                
                // Update topic title
                const titles = {
                    reading: 'Reading Comprehension',
                    math: 'Mathematics',
                    writing: 'Writing & Grammar'
                };
                document.getElementById('topic-title').textContent = titles[this.currentTopic];

                if (this.currentTopic === 'reading') {
                    this.loadReadingQuestion(question);
                } else if (this.currentTopic === 'math') {
                    this.loadMathQuestion(question);
                } else {
                    this.loadWritingQuestion(question);
                }

                this.resetAnswerOptions();
                this.updateButtons();
            }

            loadReadingQuestion(question) {
                // Show reading passage
                document.getElementById('reading-passage').classList.remove('hidden');
                document.getElementById('math-problem').classList.add('hidden');
                document.getElementById('passage-text').textContent = question.passage;
                document.getElementById('question-text').textContent = question.question;
                
                this.loadAnswerOptions(question.options);
            }

            loadMathQuestion(question) {
                // Show math problem
                document.getElementById('reading-passage').classList.add('hidden');
                document.getElementById('math-problem').classList.remove('hidden');
                document.getElementById('question-text').textContent = question.question;
                document.getElementById('math-formula').textContent = question.formula || question.question;
                
                this.loadAnswerOptions(question.options);
            }

            loadWritingQuestion(question) {
                document.getElementById('reading-passage').classList.add('hidden');
                document.getElementById('math-problem').classList.add('hidden');
                document.getElementById('question-text').textContent = question.question;
                
                this.loadAnswerOptions(question.options);
            }

            loadAnswerOptions(options) {
                const container = document.getElementById('answer-options');
                container.innerHTML = '';
                
                options.forEach((option, index) => {
                    const letter = String.fromCharCode(65 + index); // A, B, C, D
                    const optionElement = document.createElement('div');
                    optionElement.className = 'answer-option p-4 border-2 border-gray-200 rounded-xl';
                    optionElement.onclick = () => this.selectAnswer(index);
                    optionElement.innerHTML = `
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-4 font-semibold">${letter}</div>
                            <span>${option}</span>
                        </div>
                    `;
                    container.appendChild(optionElement);
                });
            }

            selectAnswer(index) {
                this.selectedAnswer = index;
                this.resetAnswerOptions();
                
                const options = document.querySelectorAll('.answer-option');
                options[index].classList.add('selected');
                
                document.getElementById('submit-btn').disabled = false;
            }

            resetAnswerOptions() {
                document.querySelectorAll('.answer-option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                });
                document.getElementById('submit-btn').disabled = true;
            }

            submitAnswer() {
                if (this.selectedAnswer === null) return;

                const question = this.sessionQuestions[this.currentQuestion];
                const isCorrect = this.selectedAnswer === question.correct;
                
                // Record answer
                this.sessionAnswers.push({
                    questionIndex: this.currentQuestion,
                    selectedAnswer: this.selectedAnswer,
                    correctAnswer: question.correct,
                    isCorrect: isCorrect,
                    timeSpent: Date.now() - this.questionStartTime
                });

                // Show correct/incorrect styling
                this.showAnswerFeedback(question, isCorrect);
                
                // Show explanation
                this.showExplanation(question, isCorrect);
                
                // Update buttons
                this.updateButtons();
            }

            showAnswerFeedback(question, isCorrect) {
                const options = document.querySelectorAll('.answer-option');
                
                // Mark selected answer
                if (isCorrect) {
                    options[this.selectedAnswer].classList.add('correct');
                } else {
                    options[this.selectedAnswer].classList.add('incorrect');
                    options[question.correct].classList.add('correct');
                }
            }

            showExplanation(question, isCorrect) {
                const panel = document.getElementById('explanation-panel');
                const text = document.getElementById('explanation-text');
                
                text.textContent = question.explanation;
                panel.classList.remove('hidden');
                
                // Animate in
                anime({
                    targets: panel,
                    opacity: [0, 1],
                    translateY: [20, 0],
                    duration: 300,
                    easing: 'easeOutQuad'
                });
            }

            nextQuestion() {
                if (this.currentQuestion < this.sessionQuestions.length - 1) {
                    this.currentQuestion++;
                    this.loadQuestion();
                } else {
                    this.completeSession();
                }
            }

            previousQuestion() {
                if (this.currentQuestion > 0) {
                    this.currentQuestion--;
                    this.loadQuestion();
                }
            }

            skipQuestion() {
                this.sessionAnswers.push({
                    questionIndex: this.currentQuestion,
                    selectedAnswer: -1,
                    correctAnswer: this.sessionQuestions[this.currentQuestion].correct,
                    isCorrect: false,
                    timeSpent: Date.now() - this.questionStartTime,
                    skipped: true
                });
                
                this.nextQuestion();
            }

            updateButtons() {
                const prevBtn = document.getElementById('prev-btn');
                const submitBtn = document.getElementById('submit-btn');
                
                prevBtn.disabled = this.currentQuestion === 0;
                submitBtn.disabled = this.selectedAnswer === null || 
                    document.getElementById('explanation-panel').classList.contains('hidden') === false;
            }

            completeSession() {
                this.stopTimer();
                
                const correctAnswers = this.sessionAnswers.filter(a => a.isCorrect).length;
                const accuracy = Math.round((correctAnswers / this.sessionAnswers.length) * 100);
                const xpEarned = correctAnswers * 10;
                
                this.showSuccessModal(correctAnswers, accuracy, xpEarned);
                this.updateStats(correctAnswers, accuracy);
            }

            showSuccessModal(correct, accuracy, xp) {
                const modal = document.getElementById('success-modal');
                const message = document.getElementById('success-message');
                const xpElement = document.getElementById('xp-earned');
                
                message.textContent = `You completed ${this.sessionAnswers.length} questions with ${accuracy}% accuracy!`;
                xpElement.textContent = `+${xp} XP`;
                
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                
                // Animate in
                anime({
                    targets: modal.querySelector('.bg-white'),
                    scale: [0.8, 1],
                    opacity: [0, 1],
                    duration: 300,
                    easing: 'easeOutBack'
                });
            }

            closeSuccessModal() {
                const modal = document.getElementById('success-modal');
                
                anime({
                    targets: modal.querySelector('.bg-white'),
                    scale: [1, 0.8],
                    opacity: [1, 0],
                    duration: 200,
                    easing: 'easeInQuad',
                    complete: () => {
                        modal.classList.add('hidden');
                        modal.classList.remove('flex');
                        this.selectTopic(this.currentTopic); // Restart session
                    }
                });
            }

            updateStats(correct, accuracy) {
                // Update questions answered
                const answeredElement = document.getElementById('questions-answered');
                const current = parseInt(answeredElement.textContent);
                answeredElement.textContent = current + this.sessionAnswers.length;
                
                // Update accuracy (simplified calculation)
                const accuracyElement = document.getElementById('accuracy-rate');
                accuracyElement.textContent = `${Math.max(accuracy, 70)}%`;
            }

            startTimer() {
                this.stopTimer();
                this.questionStartTime = Date.now();
                
                this.timerInterval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.questionStartTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    
                    const display = document.getElementById('timer-display');
                    if (display) {
                        display.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }
                }, 1000);
            }

            stopTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
                
                const display = document.getElementById('timer-display');
                if (display) {
                    display.textContent = '--:--';
                }
            }

            initChart() {
                const chartElement = document.getElementById('performance-chart');
                if (!chartElement) return;
                
                const chart = echarts.init(chartElement);
                
                const option = {
                    title: {
                        text: 'Weekly Performance',
                        left: 'center',
                        textStyle: {
                            color: '#374151',
                            fontSize: 16,
                            fontWeight: 'bold'
                        }
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['Accuracy %', 'Questions Answered'],
                        bottom: 10
                    },
                    xAxis: {
                        type: 'category',
                        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        axisLine: {
                            lineStyle: {
                                color: '#d1d5db'
                            }
                        }
                    },
                    yAxis: [
                        {
                            type: 'value',
                            name: 'Accuracy %',
                            min: 0,
                            max: 100,
                            axisLine: {
                                lineStyle: {
                                    color: '#ff6b6b'
                                }
                            }
                        },
                        {
                            type: 'value',
                            name: 'Questions',
                            min: 0,
                            max: 50,
                            axisLine: {
                                lineStyle: {
                                    color: '#4ecdc4'
                                }
                            }
                        }
                    ],
                    series: [
                        {
                            name: 'Accuracy %',
                            type: 'line',
                            data: [75, 82, 78, 85, 90, 88, 85],
                            smooth: true,
                            lineStyle: {
                                color: '#ff6b6b',
                                width: 3
                            },
                            itemStyle: {
                                color: '#ff6b6b'
                            }
                        },
                        {
                            name: 'Questions Answered',
                            type: 'bar',
                            yAxisIndex: 1,
                            data: [15, 20, 12, 25, 30, 18, 22],
                            itemStyle: {
                                color: '#4ecdc4'
                            }
                        }
                    ],
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '15%',
                        containLabel: true
                    }
                };
                
                chart.setOption(option);
                
                // Responsive
                window.addEventListener('resize', () => {
                    chart.resize();
                });
            }

            bindEvents() {
                // Handle window resize for chart
                window.addEventListener('resize', () => {
                    const chartElement = document.getElementById('performance-chart');
                    if (chartElement && echarts.getInstanceByDom(chartElement)) {
                        echarts.getInstanceByDom(chartElement).resize();
                    }
                });
            }
        }

        // Global functions
        let satApp;

        function selectTopic(topic) {
            satApp.selectTopic(topic);
        }

        function selectAnswer(index) {
            satApp.selectAnswer(index);
        }

        function submitAnswer() {
            satApp.submitAnswer();
        }

        function nextQuestion() {
            satApp.nextQuestion();
        }

        function previousQuestion() {
            satApp.previousQuestion();
        }

        function skipQuestion() {
            satApp.skipQuestion();
        }

        function closeSuccessModal() {
            satApp.closeSuccessModal();
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            satApp = new SATPrepApp();
        });
    </script>
</body>
</html>
